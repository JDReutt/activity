!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function i(o,e){this.$element=t(o),this.options=t.extend({},i.DEFAULTS,t.isPlainObject(e)&&e),this.init()}var o=(window.FormData,"qor.activity"),e="enable."+o,a="disable."+o,n="click."+o,r="submit."+o,s="qor-activity__edit-button",d=".qor-activity__edit-note_form",c=".qor-activity__new-note_form",l="#template__qor-activity__list",u=".qor-activity__lists";return i.prototype={constructor:i,init:function(){this.$element;this.bind()},bind:function(){this.$element.on(n,t.proxy(this.click,this)).on(r,"form",t.proxy(this.submit,this))},submit:function(o){var e,a,n=(o.target,t(o.target)),r=this;return o.preventDefault(),e=n.serialize(),t.ajax(n.prop("action"),{method:n.prop("method"),data:e,dataType:"json"}).done(function(o){if(!o.errors&&(n.is(d)&&(r.hideEditForm(n),n.find(".qor-activity__list-note").html(o.Note)),n.is(c))){a=i.ACTIVITY_LIST_TEMPLATE,Mustache.parse(a);var e=Mustache.render(a,o);t(u).append(e),r.clearForm()}}),!1},clearForm:function(){t('textarea[data-toggle="qor.redactor"]').redactor("code.set",""),t(c).find("textarea").val("")},click:function(i){var o=t(i.target);if(i.stopPropagation(),o.hasClass(s)){var e=o.closest(".qor-activity__list");this.showEditForm(e)}},showEditForm:function(t){t.find(".qor-activity__list-note,.qor-activity__edit-button").removeClass("show").addClass("hide"),t.find(".qor-activity__edit-feilds,.qor-activity__edit-save-button").removeClass("hide").addClass("show")},hideEditForm:function(t){t.find(".qor-activity__list-note,.qor-activity__edit-button").removeClass("hide").addClass("show"),t.find(".qor-activity__edit-feilds,.qor-activity__edit-save-button").removeClass("show").addClass("hide")}},i.CONTENT_HTML='<div class="mdl-layout mdl-js-layout qor-sliderout__activity-container"><main class="mdl-layout__content qor-slideout--activity-content"><div class="mdl-layout__tab-panel is-active" id="scroll-tab-form"></div></main></div>',i.DEFAULTS={},i.ACTIVITY_LIST_TEMPLATE={},i.plugin=function(e){return this.each(function(){var a,n=t(this),r=n.data(o);if(!r){if(/destroy/.test(e))return;n.data(o,r=new i(this,e))}"string"==typeof e&&t.isFunction(a=r[e])&&a.apply(r)})},t.fn.qorSliderAfterShow.qorActivityinit=function(o){var e=o;t.ajax({url:e}).done(function(o){var e=t(".qor-slideout > .qor-slideout__body"),a=t(o),n=a.find(".qor-tab-bar--activity-header");i.ACTIVITY_LIST_TEMPLATE=a.find(l).html(),e.wrapInner(i.CONTENT_HTML),t(".qor-sliderout__activity-container").prepend(n),t(".qor-slideout--activity-content").append(a.find("#scroll-tab-activity"))})},t(function(){var o='[data-toggle="qor.activity"]';t(document).on(a,function(e){i.plugin.call(t(o,e.target),"destroy")}).on(e,function(e){i.plugin.call(t(o,e.target))}).triggerHandler(e)}),i});